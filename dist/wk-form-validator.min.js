'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&'function'==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?'symbol':typeof b},_createClass=function(){function b(d,f){for(var h,g=0;g<f.length;g++)h=f[g],h.enumerable=h.enumerable||!1,h.configurable=!0,'value'in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}return function(d,f,g){return f&&b(d.prototype,f),g&&b(d,g),d}}();function _classCallCheck(b,d){if(!(b instanceof d))throw new TypeError('Cannot call a class as a function')}var WKFormItem=function(){function b(d){_classCallCheck(this,b);var f=['radio','checkbox','text','file','date','number','email','password','tel'],g=['input','textarea','select'];if(!d||!this.isElement(d))throw new Error('Provided element is not a valid DOM Element');if(!g.includes(d.tagName.toLowerCase()))throw new Error('Provided DOM Element is currently not supported (supported elements: '+g.join(', ')+')');if('INPUT'==d.tagName&&!f.includes(d.getAttribute('type')))throw new Error('Proveded Form Input type is currently not supported (supported types: '+f.join(', ')+')');this.tagName=d.tagName.toLowerCase(),this.type='input'==this.tagName?d.getAttribute('type'):this.tagName,this.name=d.getAttribute('name'),this.DOM_NODE='radio'==this.type?document.querySelectorAll('input[type=radio][name='+this.name+']'):d}return _createClass(b,[{key:'addClass',value:function addClass(d){if('radio'==this.type)for(var f=0;f<this.DOM_NODE.length;f++)this.DOM_NODE[f].classList.add(d);else this.DOM_NODE.classList.add(d)}},{key:'removeClass',value:function removeClass(d){if('radio'==this.type)for(var f=0;f<this.DOM_NODE.length;f++)this.DOM_NODE[f].classList.remove(d);else this.DOM_NODE.classList.remove(d)}},{key:'value',value:function value(){if('radio'==this.type)for(var d='',f=0;f<this.DOM_NODE.length;f++)this.DOM_NODE[f].checked&&'on'!=this.DOM_NODE[f].value&&'off'!=this.DOM_NODE[f].value&&(d=this.DOM_NODE[f].value);else return this.DOM_NODE.value}},{key:'isElement',value:function isElement(d){return d instanceof Element||d instanceof HTMLDocument}}]),b}(),WKFormValidator=function(){function b(d,f){var h=this;if(_classCallCheck(this,b),this.isElement(d))this.$form=d;else{var g=document.querySelector(d);if(g)this.$form=g;else throw new Error('Cannot find HTML Element with given selector')}if(this.$form.addEventListener('submit',function(q){'true'!=h.$form.getAttribute('data-wkvalid')&&(q.preventDefault(),h.validate())}),!f||'object'!=('undefined'==typeof f?'undefined':_typeof(f)))throw new Error('Missing configuration object or given data is not an object');this.$inputErrorClass=f.hasOwnProperty('inputErrorClass')&&'string'==typeof f.inputErrorClass?f.inputErrorClass:'incorrect',this.$inputMsgBoxSelectorPattern=f.hasOwnProperty('inputMsgBoxSelectorPattern')&&'string'==typeof f.inputMsgBoxSelectorPattern?f.inputMsgBoxSelectorPattern:'.%{name}-incorrect-msg',this.$inputMsgBoxClass=f.hasOwnProperty('inputMsgBoxClass')&&'string'==typeof f.inputMsgBoxClass?f.inputMsgBoxClass:'incorrect-msg',this.$inputMsgBoxActiveClass=f.hasOwnProperty('inputMsgBoxActiveClass')&&'string'==typeof f.inputMsgBoxActiveClass?f.inputMsgBoxActiveClass:'active',this.$validationErrorCallback=f.hasOwnProperty('validationErrorCallback')&&'function'==typeof f.validationErrorCallback?f.validationErrorCallback:null,this.$schema=f.hasOwnProperty('schema')&&'object'==_typeof(f.schema)?Object.entries(f.schema):[],this.$inputs={};for(var l=0;l<this.$form.elements.length;l++){var n=this.$form.elements[l],o=void 0;if(!('radio'==n.getAttribute('type')&&this.$inputs.hasOwnProperty(this.caseConverter(n.getAttribute('name')))))try{o=new WKFormItem(n),this.$inputs[this.caseConverter(o.name)]=o}catch(r){continue}}}return _createClass(b,[{key:'validate',value:function validate(){var f=this;this.cleanErrors();var d=!1;this.$schema.forEach(function(g){var h=g[0],l=g[1];if(f.$inputs.hasOwnProperty(h)){var n=f.$inputs[h],o=[],q=!1;if(l.hasOwnProperty('required'))if(!0===l.required||'object'==_typeof(l.required)&&l.required.hasOwnProperty('value')&&!0===l.required.value){var r=!1;if('radio'==n.type){for(var t=0;t<n.DOM_NODE.length;t++)if(!0===n.DOM_NODE[t].checked){break}s||(r=!0)}else'checkbox'==n.type?n.DOM_NODE.checked||(r=!0):''==n.value()&&(r=!0);r&&(q=!0,'object'==_typeof(l.required)&&l.required.hasOwnProperty('msg')&&o.push(l.required.msg))}else console.error('Presence test value for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.');if('textarea'==n.tagName||'input'==n.tagName&&'radio'!=n.type&&'checkbox'!=n.type){if(l.hasOwnProperty('minLength')){var u=!1;'number'==typeof l.minLength&&0<=l.minLength?n.value().split('').length<l.minLength&&(u=!0):'object'==_typeof(l.minLength)&&l.minLength.hasOwnProperty('value')&&'number'==typeof l.minLength.value&&0<=l.minLength.value?n.value().split('').length<l.minLength.value&&(u=!0,l.minLength.hasOwnProperty('msg')&&o.push(l.minLength.msg)):console.error('MinLength test value for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.'),u&&(q=!0)}if(l.hasOwnProperty('maxLength')){var w=!1;'number'==typeof l.maxLength&&0<l.maxLength?n.value().split('').length>l.maxLength&&(w=!0):'object'==_typeof(l.maxLength)&&l.maxLength.hasOwnProperty('value')&&'number'==typeof l.maxLength.value&&0<l.maxLength.value?n.value().split('').length>l.maxLength.value&&(w=!0,l.maxLength.hasOwnProperty('msg')&&o.push(l.maxLength.msg)):console.error('MaxLength test value for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.'),w&&(q=!0)}if(l.hasOwnProperty('pattern')){var y=!1,z=null;'object'==_typeof(l.pattern)&&l.pattern instanceof RegExp?z=l.pattern:'object'==_typeof(l.pattern)&&l.pattern.hasOwnProperty('value')&&'object'==_typeof(l.pattern.value)&&l.pattern.value instanceof RegExp?(z=l.pattern.value,l.pattern.hasOwnProperty('msg')&&(y=!0)):console.error('Pattern test value for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.');try{z=new RegExp(z),z.test(n.value())||(q=!0,y&&o.push(l.pattern.msg))}catch(K){console.error('Regular expression passed to test input with name '+n.name+' is incorrect, check error message below:'),console.error(K)}}if(l.hasOwnProperty('exactValue')){var A=!1,B=null,C=!1,D=!1;'string'==typeof l.exactValue?B=l.exactValue:'object'==_typeof(l.exactValue)&&l.exactValue.hasOwnProperty('value')&&'string'==typeof l.exactValue.value?(B=l.exactValue.value,l.exactValue.hasOwnProperty('msg')&&(A=!0),l.exactValue.hasOwnProperty('caseSensitive')&&!1===l.exactValue.caseSensitive&&(C=!0),l.exactValue.hasOwnProperty('varSyntax')&&'string'==typeof l.exactValue.varSyntax&&(D=l.exactValue.varSyntax)):console.error('ExactValue test value for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.');var E=f.varExtractor(B,D);if(0<E.length)for(var F=0;F<E.length;F++)B=B.replace(E[F].value,f.$inputs[f.caseConverter(E[F].varName)].value());var G=n.value();C&&(G=G.toLowerCase(),B=B.toLowerCase()),B!=G&&(q=!0,A&&o.push(l.exactValue.msg))}}if('input'==n.tagName&&'number'==n.type){if(l.hasOwnProperty('min')){var H=!1;'number'==typeof l.min&&0<=l.min?n.value()<l.min&&(H=!0):'object'==_typeof(l.min)&&l.min.hasOwnProperty('value')&&'number'==typeof l.min.value&&0<=l.min.value?n.value()<l.min.value&&(H=!0,l.min.hasOwnProperty('msg')&&o.push(l.min.msg)):console.error('Min test for number input for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.'),H&&(q=!0)}if(l.hasOwnProperty('max')){var I=!1;'number'==typeof l.max&&0<l.max?n.value()>l.max&&(I=!0):'object'==_typeof(l.max)&&l.max.hasOwnProperty('value')&&'number'==typeof l.max.value&&0<l.max.value?n.value()>l.max.value&&(I=!0,l.max.hasOwnProperty('msg')&&o.push(l.max.msg)):console.error('Max test for number input for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.'),I&&(q=!0)}if(l.hasOwnProperty('step')){var J=!1;'number'==typeof l.step&&0<l.step?0!=n.value()%l.step&&(J=!0):'object'==_typeof(l.step)&&l.step.hasOwnProperty('value')&&'number'==typeof l.step.value&&0<l.step.value?0!=n.value()%l.step.value&&(J=!0,l.step.hasOwnProperty('msg')&&o.push(l.step.msg)):console.error('Step test for number input for input with name '+n.name+' is incorrect. Please check documentation how to build schema ocject properly.'),J&&(q=!0)}}q&&(f.displayError(n.name,o.join(', ')),d=!0)}}),d?this.$validationErrorCallback&&this.$validationErrorCallback():(this.$form.setAttribute('data-wkvalid',!0),this.$form.submit())}},{key:'displayError',value:function displayError(d,f){this.$inputs[this.caseConverter(d)].addClass(this.$inputErrorClass);var g=document.querySelector(this.$inputMsgBoxSelectorPattern.replace('%{name}',d));g&&(f&&''!=f&&(g.innerText=f),g.classList.add(this.$inputMsgBoxActiveClass))}},{key:'cleanErrors',value:function cleanErrors(){for(var d=this.$form.querySelectorAll('.'+this.$inputMsgBoxClass+'.'+this.$inputMsgBoxActiveClass),f=0;f<d.length;f++)d[f].classList.remove(this.$inputMsgBoxActiveClass);for(var g in this.$inputs)this.$inputs[g].removeClass(this.$inputErrorClass)}},{key:'caseConverter',value:function caseConverter(d){for(d=d.replace(/[^A-z0-9-_]/g,''),d=d.replace(/[-]+/g,'-'),d=d.split('');'-'==d[d.length-1];)d.pop();if(d=d.join(''),0==d.search(/[0-9]/))throw new Error('Input name is invalid, digit is not allowed as a first character');for(;-1!=d.indexOf('-');){var f=d.indexOf('-');d=d.replace('-',''),d=d.substr(0,f)+d.slice(f,f+1).toUpperCase()+d.substr(f+1)}return d}},{key:'varExtractor',value:function varExtractor(d,f){var g='%{',h='}',l=[];if(f&&'string'==typeof f&&-1!=f.indexOf('#')){var n=f.indexOf('#');g=f.substring(0,n),h=f.substring(n+1)}for(var o=0;-1!=d.indexOf(g,o);){o=d.indexOf(g,o);var q=d.indexOf(h,o);l.push({value:d.slice(o,q+1),varName:d.slice(o+g.split('').length,q),start:o,end:q}),o=q+1}return l}},{key:'isElement',value:function isElement(d){return d instanceof Element||d instanceof HTMLDocument}}]),b}();